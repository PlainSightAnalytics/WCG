

CREATE PROCEDURE [itis].[prcExtractvehicle]

--------------------------------------------------------------------------------------------------------------------------------------
-- Author				:	Generated from Model
-- Date Created			:	21-12-2017 04:06:55
-- Reason				:	Reads JSON file and inserts data into Stage table (vehicle)
--------------------------------------------------------------------------------------------------------------------------------------
-- Inputs				:	@FileName, @DeltaLogKey, @AuditKey
-- Ouputs				:	@RowCountStage
-- Test					:	exec itis.prcExtractvehicle 'D:\PSA\WCG\sql\vehicle.json'
--------------------------------------------------------------------------------------------------------------------------------------
-- Modified By	:
-- Modified On	:
-- Reason				:
--------------------------------------------------------------------------------------------------------------------------------------

@FileName NVARCHAR(MAX),
@DeltaLogKey INT = -1,
@AuditKey INT = -1,
@TruncateFlag INT = 1

AS

IF @TruncateFlag = 1 TRUNCATE TABLE [itis].[vehicle]

DECLARE @sql AS NVARCHAR(MAX)

SET @sql = 'DECLARE @json NVARCHAR(MAX) ' + CHAR(13)
SET @sql = @sql + 'SELECT @json = BulkColumn FROM OPENROWSET (BULK ''' + @FileName + ''', SINGLE_CLOB) as j' + CHAR(13)
SET @sql = @sql + 'INSERT INTO [itis].[vehicle] (' + CHAR(13)
SET @sql = @sql + '[id], ' + CHAR(13)
SET @sql = @sql + '[type], ' + CHAR(13)
SET @sql = @sql + '[updated_at], ' + CHAR(13)
SET @sql = @sql + '[display], ' + CHAR(13)
--Insert Begin
SET @sql = @sql + '[device_id], ' + CHAR(13)
SET @sql = @sql + '[event_id], ' + CHAR(13)
SET @sql = @sql + '[user_id], ' + CHAR(13)
SET @sql = @sql + '[address_street_1], ' + CHAR(13)
SET @sql = @sql + '[address_street_2], ' + CHAR(13)
SET @sql = @sql + '[address_street_3], ' + CHAR(13)
SET @sql = @sql + '[address_street_4], ' + CHAR(13)
SET @sql = @sql + '[address_street_5], ' + CHAR(13)
SET @sql = @sql + '[address_street_postal_code], ' + CHAR(13)
SET @sql = @sql + '[colour_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[colour_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[colour_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[description_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[description_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[description_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[economic_sector_description], ' + CHAR(13)
SET @sql = @sql + '[enatis_lookup_type_key], ' + CHAR(13)
SET @sql = @sql + '[enatis_lookup_type_display], ' + CHAR(13)
SET @sql = @sql + '[enatis_summary], ' + CHAR(13)
SET @sql = @sql + '[enatis_time_updated], ' + CHAR(13)
SET @sql = @sql + '[engine_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[engine_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[engine_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[engine_number], ' + CHAR(13)
SET @sql = @sql + '[engine_number_captured], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_latitude], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_longitude], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_altitude], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_horizontal_accuracy], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_vertical_accuracy], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_timestamp], ' + CHAR(13)
SET @sql = @sql + '[have_checked_enatis_key], ' + CHAR(13)
SET @sql = @sql + '[have_checked_enatis_display], ' + CHAR(13)
SET @sql = @sql + '[helper_number_captured], ' + CHAR(13)
SET @sql = @sql + '[history_1_location], ' + CHAR(13)
SET @sql = @sql + '[history_1_timestamp], ' + CHAR(13)
SET @sql = @sql + '[history_1_violation_key], ' + CHAR(13)
SET @sql = @sql + '[history_1_violation_display], ' + CHAR(13)
SET @sql = @sql + '[history_2_location], ' + CHAR(13)
SET @sql = @sql + '[history_2_timestamp], ' + CHAR(13)
SET @sql = @sql + '[history_2_violation_key], ' + CHAR(13)
SET @sql = @sql + '[history_2_violation_display], ' + CHAR(13)
SET @sql = @sql + '[history_3_location], ' + CHAR(13)
SET @sql = @sql + '[history_3_timestamp], ' + CHAR(13)
SET @sql = @sql + '[history_3_violation_key], ' + CHAR(13)
SET @sql = @sql + '[history_3_violation_display], ' + CHAR(13)
SET @sql = @sql + '[initials], ' + CHAR(13)
SET @sql = @sql + '[is_public_transport_vehicle_captured_key], ' + CHAR(13)
SET @sql = @sql + '[is_public_transport_vehicle_captured_display], ' + CHAR(13)
SET @sql = @sql + '[license_certificate_number], ' + CHAR(13)
SET @sql = @sql + '[license_certificate_number_captured], ' + CHAR(13)
SET @sql = @sql + '[license_change_date], ' + CHAR(13)
SET @sql = @sql + '[license_disc_photo_captured], ' + CHAR(13)
SET @sql = @sql + '[license_disk_present_captured_key], ' + CHAR(13)
SET @sql = @sql + '[license_disk_present_captured_display], ' + CHAR(13)
SET @sql = @sql + '[license_expiry_date], ' + CHAR(13)
SET @sql = @sql + '[license_expiry_date_captured], ' + CHAR(13)
SET @sql = @sql + '[license_number], ' + CHAR(13)
SET @sql = @sql + '[license_number_captured], ' + CHAR(13)
SET @sql = @sql + '[make_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[make_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[make_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[method_captured_key], ' + CHAR(13)
SET @sql = @sql + '[method_captured_display], ' + CHAR(13)
SET @sql = @sql + '[model_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[model_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[model_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[nature_of_person_description], ' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_type_captured_key], ' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_type_captured_display], ' + CHAR(13)
SET @sql = @sql + '[numberplate_photo_captured], ' + CHAR(13)
SET @sql = @sql + '[numberplate_present_captured_key], ' + CHAR(13)
SET @sql = @sql + '[numberplate_present_captured_display], ' + CHAR(13)
SET @sql = @sql + '[operating_license_number_captured], ' + CHAR(13)
SET @sql = @sql + '[owner_id_document_number], ' + CHAR(13)
SET @sql = @sql + '[owner_id_document_type], ' + CHAR(13)
SET @sql = @sql + '[owner_id_document_type_code], ' + CHAR(13)
SET @sql = @sql + '[previous_license_number], ' + CHAR(13)
SET @sql = @sql + '[registration_description], ' + CHAR(13)
SET @sql = @sql + '[roadworthy_status], ' + CHAR(13)
SET @sql = @sql + '[sap_clearance_status], ' + CHAR(13)
SET @sql = @sql + '[sap_mark_code], ' + CHAR(13)
SET @sql = @sql + '[sap_mark_description], ' + CHAR(13)
SET @sql = @sql + '[scan_registration_number], ' + CHAR(13)
SET @sql = @sql + '[status_key], ' + CHAR(13)
SET @sql = @sql + '[status_display], ' + CHAR(13)
SET @sql = @sql + '[surname_business_name], ' + CHAR(13)
SET @sql = @sql + '[timestamp_captured], ' + CHAR(13)
SET @sql = @sql + '[user_location_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_1_key], ' + CHAR(13)
SET @sql = @sql + '[vehicle_1_display], ' + CHAR(13)
SET @sql = @sql + '[vehicle_2_key], ' + CHAR(13)
SET @sql = @sql + '[vehicle_2_display], ' + CHAR(13)
SET @sql = @sql + '[vehicle_3_key], ' + CHAR(13)
SET @sql = @sql + '[vehicle_3_display], ' + CHAR(13)
SET @sql = @sql + '[vehicle_colour], ' + CHAR(13)
SET @sql = @sql + '[vehicle_colour_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_description], ' + CHAR(13)
SET @sql = @sql + '[vehicle_description_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_designation_key], ' + CHAR(13)
SET @sql = @sql + '[vehicle_designation_display], ' + CHAR(13)
SET @sql = @sql + '[vehicle_gmv], ' + CHAR(13)
SET @sql = @sql + '[vehicle_make], ' + CHAR(13)
SET @sql = @sql + '[vehicle_make_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_model_description], ' + CHAR(13)
SET @sql = @sql + '[vehicle_model_description_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_register_number], ' + CHAR(13)
SET @sql = @sql + '[vehicle_register_number_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_registration_number], ' + CHAR(13)
SET @sql = @sql + '[vehicle_registration_number_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_state], ' + CHAR(13)
SET @sql = @sql + '[vehicle_usage_description], ' + CHAR(13)
SET @sql = @sql + '[vin_chassis_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[vin_chassis_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[vin_chassis_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[vin_chassis_number], ' + CHAR(13)
SET @sql = @sql + '[vin_chassis_number_captured], ' + CHAR(13)
SET @sql = @sql + '[voluntary_lookup_key], ' + CHAR(13)
SET @sql = @sql + '[voluntary_lookup_display], ' + CHAR(13)
SET @sql = @sql + '[deltalogkey],' + CHAR(13)
SET @sql = @sql + '[AuditKey]' + CHAR(13)
--Insert End
SET @sql = @sql + ')' + CHAR(13)
SET @sql = @sql + 'SELECT ' 
--Select Begin
SET @sql = @sql + '[id], ' + CHAR(13)
SET @sql = @sql + '[type], ' + CHAR(13)
SET @sql = @sql + '[updated_at], ' + CHAR(13)
SET @sql = @sql + '[display], ' + CHAR(13)
SET @sql = @sql + '[device_id], ' + CHAR(13)
SET @sql = @sql + '[event_id], ' + CHAR(13)
SET @sql = @sql + '[user_id], ' + CHAR(13)
SET @sql = @sql + '[address_street_1], ' + CHAR(13)
SET @sql = @sql + '[address_street_2], ' + CHAR(13)
SET @sql = @sql + '[address_street_3], ' + CHAR(13)
SET @sql = @sql + '[address_street_4], ' + CHAR(13)
SET @sql = @sql + '[address_street_5], ' + CHAR(13)
SET @sql = @sql + '[address_street_postal_code], ' + CHAR(13)
SET @sql = @sql + '[colour_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[colour_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[colour_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[description_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[description_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[description_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[economic_sector_description], ' + CHAR(13)
SET @sql = @sql + '[enatis_lookup_type_key], ' + CHAR(13)
SET @sql = @sql + '[enatis_lookup_type_display], ' + CHAR(13)
SET @sql = @sql + '[enatis_summary], ' + CHAR(13)
SET @sql = @sql + '[enatis_time_updated], ' + CHAR(13)
SET @sql = @sql + '[engine_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[engine_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[engine_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[engine_number], ' + CHAR(13)
SET @sql = @sql + '[engine_number_captured], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_latitude], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_longitude], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_altitude], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_horizontal_accuracy], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_vertical_accuracy], ' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_timestamp], ' + CHAR(13)
SET @sql = @sql + '[have_checked_enatis_key], ' + CHAR(13)
SET @sql = @sql + '[have_checked_enatis_display], ' + CHAR(13)
SET @sql = @sql + '[helper_number_captured], ' + CHAR(13)
SET @sql = @sql + '[history_1_location], ' + CHAR(13)
SET @sql = @sql + '[history_1_timestamp], ' + CHAR(13)
SET @sql = @sql + '[history_1_violation_key], ' + CHAR(13)
SET @sql = @sql + '[history_1_violation_display], ' + CHAR(13)
SET @sql = @sql + '[history_2_location], ' + CHAR(13)
SET @sql = @sql + '[history_2_timestamp], ' + CHAR(13)
SET @sql = @sql + '[history_2_violation_key], ' + CHAR(13)
SET @sql = @sql + '[history_2_violation_display], ' + CHAR(13)
SET @sql = @sql + '[history_3_location], ' + CHAR(13)
SET @sql = @sql + '[history_3_timestamp], ' + CHAR(13)
SET @sql = @sql + '[history_3_violation_key], ' + CHAR(13)
SET @sql = @sql + '[history_3_violation_display], ' + CHAR(13)
SET @sql = @sql + '[initials], ' + CHAR(13)
SET @sql = @sql + '[is_public_transport_vehicle_captured_key], ' + CHAR(13)
SET @sql = @sql + '[is_public_transport_vehicle_captured_display], ' + CHAR(13)
SET @sql = @sql + '[license_certificate_number], ' + CHAR(13)
SET @sql = @sql + '[license_certificate_number_captured], ' + CHAR(13)
SET @sql = @sql + '[license_change_date], ' + CHAR(13)
SET @sql = @sql + '[license_disc_photo_captured], ' + CHAR(13)
SET @sql = @sql + '[license_disk_present_captured_key], ' + CHAR(13)
SET @sql = @sql + '[license_disk_present_captured_display], ' + CHAR(13)
SET @sql = @sql + '[license_expiry_date], ' + CHAR(13)
SET @sql = @sql + '[license_expiry_date_captured], ' + CHAR(13)
SET @sql = @sql + '[license_number], ' + CHAR(13)
SET @sql = @sql + '[license_number_captured], ' + CHAR(13)
SET @sql = @sql + '[make_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[make_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[make_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[method_captured_key], ' + CHAR(13)
SET @sql = @sql + '[method_captured_display], ' + CHAR(13)
SET @sql = @sql + '[model_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[model_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[model_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[nature_of_person_description], ' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_type_captured_key], ' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_type_captured_display], ' + CHAR(13)
SET @sql = @sql + '[numberplate_photo_captured], ' + CHAR(13)
SET @sql = @sql + '[numberplate_present_captured_key], ' + CHAR(13)
SET @sql = @sql + '[numberplate_present_captured_display], ' + CHAR(13)
SET @sql = @sql + '[operating_license_number_captured], ' + CHAR(13)
SET @sql = @sql + '[owner_id_document_number], ' + CHAR(13)
SET @sql = @sql + '[owner_id_document_type], ' + CHAR(13)
SET @sql = @sql + '[owner_id_document_type_code], ' + CHAR(13)
SET @sql = @sql + '[previous_license_number], ' + CHAR(13)
SET @sql = @sql + '[registration_description], ' + CHAR(13)
SET @sql = @sql + '[roadworthy_status], ' + CHAR(13)
SET @sql = @sql + '[sap_clearance_status], ' + CHAR(13)
SET @sql = @sql + '[sap_mark_code], ' + CHAR(13)
SET @sql = @sql + '[sap_mark_description], ' + CHAR(13)
SET @sql = @sql + '[scan_registration_number], ' + CHAR(13)
SET @sql = @sql + '[status_key], ' + CHAR(13)
SET @sql = @sql + '[status_display], ' + CHAR(13)
SET @sql = @sql + '[surname_business_name], ' + CHAR(13)
SET @sql = @sql + '[timestamp_captured], ' + CHAR(13)
SET @sql = @sql + '[user_location_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_1_key], ' + CHAR(13)
SET @sql = @sql + '[vehicle_1_display], ' + CHAR(13)
SET @sql = @sql + '[vehicle_2_key], ' + CHAR(13)
SET @sql = @sql + '[vehicle_2_display], ' + CHAR(13)
SET @sql = @sql + '[vehicle_3_key], ' + CHAR(13)
SET @sql = @sql + '[vehicle_3_display], ' + CHAR(13)
SET @sql = @sql + '[vehicle_colour], ' + CHAR(13)
SET @sql = @sql + '[vehicle_colour_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_description], ' + CHAR(13)
SET @sql = @sql + '[vehicle_description_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_designation_key], ' + CHAR(13)
SET @sql = @sql + '[vehicle_designation_display], ' + CHAR(13)
SET @sql = @sql + '[vehicle_gmv], ' + CHAR(13)
SET @sql = @sql + '[vehicle_make], ' + CHAR(13)
SET @sql = @sql + '[vehicle_make_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_model_description], ' + CHAR(13)
SET @sql = @sql + '[vehicle_model_description_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_register_number], ' + CHAR(13)
SET @sql = @sql + '[vehicle_register_number_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_registration_number], ' + CHAR(13)
SET @sql = @sql + '[vehicle_registration_number_captured], ' + CHAR(13)
SET @sql = @sql + '[vehicle_state], ' + CHAR(13)
SET @sql = @sql + '[vehicle_usage_description], ' + CHAR(13)
SET @sql = @sql + '[vin_chassis_mismatch_captured], ' + CHAR(13)
SET @sql = @sql + '[vin_chassis_mismatch_description_captured], ' + CHAR(13)
SET @sql = @sql + '[vin_chassis_mismatch_potential_violation_captured], ' + CHAR(13)
SET @sql = @sql + '[vin_chassis_number], ' + CHAR(13)
SET @sql = @sql + '[vin_chassis_number_captured], ' + CHAR(13)
SET @sql = @sql + '[voluntary_lookup_key], ' + CHAR(13)
SET @sql = @sql + '[voluntary_lookup_display], ' + CHAR(13)
--Select End
SET @sql = @sql + CAST(@DeltaLogKey AS VARCHAR(10)) + ',' + CAST(@AuditKey AS VARCHAR(10)) +  CHAR(13)
SET @sql = @sql + 'FROM OPENJSON(@json, ''$.objects'') '   + CHAR(13)
SET @sql = @sql + 'WITH ( ' + CHAR(13)
--WITH Begin
SET @sql = @sql + '[id] [uniqueidentifier] ''$.id'',' + CHAR(13)
SET @sql = @sql + '[type] [nvarchar](max) ''$.type'',' + CHAR(13)
SET @sql = @sql + '[updated_at] [nvarchar](max) ''$.updated_at'',' + CHAR(13)
SET @sql = @sql + '[display] [nvarchar](max) ''$.display'',' + CHAR(13)
SET @sql = @sql + '[device_id] [varchar](max) ''$.device_id'',' + CHAR(13)
SET @sql = @sql + '[event_id] [varchar](max) ''$.event_id'',' + CHAR(13)
SET @sql = @sql + '[user_id] [varchar](max) ''$.user_id'',' + CHAR(13)
SET @sql = @sql + '[address_street_1] [varchar](max) ''$.address_street_1'',' + CHAR(13)
SET @sql = @sql + '[address_street_2] [varchar](max) ''$.address_street_2'',' + CHAR(13)
SET @sql = @sql + '[address_street_3] [varchar](max) ''$.address_street_3'',' + CHAR(13)
SET @sql = @sql + '[address_street_4] [varchar](max) ''$.address_street_4'',' + CHAR(13)
SET @sql = @sql + '[address_street_5] [varchar](max) ''$.address_street_5'',' + CHAR(13)
SET @sql = @sql + '[address_street_postal_code] [varchar](max) ''$.address_street_postal_code'',' + CHAR(13)
SET @sql = @sql + '[colour_mismatch_captured] [varchar](max) ''$.colour_mismatch_captured'',' + CHAR(13)
SET @sql = @sql + '[colour_mismatch_description_captured] [varchar](max) ''$.colour_mismatch_description_captured'',' + CHAR(13)
SET @sql = @sql + '[colour_mismatch_potential_violation_captured] [varchar](max) ''$.colour_mismatch_potential_violation_captured'',' + CHAR(13)
SET @sql = @sql + '[description_mismatch_captured] [varchar](max) ''$.description_mismatch_captured'',' + CHAR(13)
SET @sql = @sql + '[description_mismatch_description_captured] [varchar](max) ''$.description_mismatch_description_captured'',' + CHAR(13)
SET @sql = @sql + '[description_mismatch_potential_violation_captured] [varchar](max) ''$.description_mismatch_potential_violation_captured'',' + CHAR(13)
SET @sql = @sql + '[economic_sector_description] [varchar](max) ''$.economic_sector_description'',' + CHAR(13)
SET @sql = @sql + '[enatis_lookup_type_key] [varchar](max) ''$.enatis_lookup_type.key'',' + CHAR(13)
SET @sql = @sql + '[enatis_lookup_type_display] [varchar](max) ''$.enatis_lookup_type.display'',' + CHAR(13)
SET @sql = @sql + '[enatis_summary] [varchar](max) ''$.enatis_summary'',' + CHAR(13)
SET @sql = @sql + '[enatis_time_updated] [varchar](max) ''$.enatis_time_updated'',' + CHAR(13)
SET @sql = @sql + '[engine_mismatch_captured] [varchar](max) ''$.engine_mismatch_captured'',' + CHAR(13)
SET @sql = @sql + '[engine_mismatch_description_captured] [varchar](max) ''$.engine_mismatch_description_captured'',' + CHAR(13)
SET @sql = @sql + '[engine_mismatch_potential_violation_captured] [varchar](max) ''$.engine_mismatch_potential_violation_captured'',' + CHAR(13)
SET @sql = @sql + '[engine_number] [varchar](max) ''$.engine_number'',' + CHAR(13)
SET @sql = @sql + '[engine_number_captured] [varchar](max) ''$.engine_number_captured'',' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_latitude] [varchar](max) ''$.gps_location_captured.latitude'',' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_longitude] [varchar](max) ''$.gps_location_captured.longitude'',' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_altitude] [varchar](max) ''$.gps_location_captured.altitude'',' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_horizontal_accuracy] [varchar](max) ''$.gps_location_captured.horizontal_accuracy'',' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_vertical_accuracy] [varchar](max) ''$.gps_location_captured.vertical_accuracy'',' + CHAR(13)
SET @sql = @sql + '[gps_location_captured_timestamp] [varchar](max) ''$.gps_location_captured.timestamp'',' + CHAR(13)
SET @sql = @sql + '[have_checked_enatis_key] [varchar](max) ''$.have_checked_enatis.key'',' + CHAR(13)
SET @sql = @sql + '[have_checked_enatis_display] [varchar](max) ''$.have_checked_enatis.display'',' + CHAR(13)
SET @sql = @sql + '[helper_number_captured] [varchar](max) ''$.helper_number_captured'',' + CHAR(13)
SET @sql = @sql + '[history_1_location] [varchar](max) ''$.history_1_location'',' + CHAR(13)
SET @sql = @sql + '[history_1_timestamp] [varchar](max) ''$.history_1_timestamp'',' + CHAR(13)
SET @sql = @sql + '[history_1_violation_key] [varchar](max) ''$.history_1_violation.key'',' + CHAR(13)
SET @sql = @sql + '[history_1_violation_display] [varchar](max) ''$.history_1_violation.display'',' + CHAR(13)
SET @sql = @sql + '[history_2_location] [varchar](max) ''$.history_2_location'',' + CHAR(13)
SET @sql = @sql + '[history_2_timestamp] [varchar](max) ''$.history_2_timestamp'',' + CHAR(13)
SET @sql = @sql + '[history_2_violation_key] [varchar](max) ''$.history_2_violation.key'',' + CHAR(13)
SET @sql = @sql + '[history_2_violation_display] [varchar](max) ''$.history_2_violation.display'',' + CHAR(13)
SET @sql = @sql + '[history_3_location] [varchar](max) ''$.history_3_location'',' + CHAR(13)
SET @sql = @sql + '[history_3_timestamp] [varchar](max) ''$.history_3_timestamp'',' + CHAR(13)
SET @sql = @sql + '[history_3_violation_key] [varchar](max) ''$.history_3_violation.key'',' + CHAR(13)
SET @sql = @sql + '[history_3_violation_display] [varchar](max) ''$.history_3_violation.display'',' + CHAR(13)
SET @sql = @sql + '[initials] [varchar](max) ''$.initials'',' + CHAR(13)
SET @sql = @sql + '[is_public_transport_vehicle_captured_key] [varchar](max) ''$.is_public_transport_vehicle_captured.key'',' + CHAR(13)
SET @sql = @sql + '[is_public_transport_vehicle_captured_display] [varchar](max) ''$.is_public_transport_vehicle_captured.display'',' + CHAR(13)
SET @sql = @sql + '[license_certificate_number] [varchar](max) ''$.license_certificate_number'',' + CHAR(13)
SET @sql = @sql + '[license_certificate_number_captured] [varchar](max) ''$.license_certificate_number_captured'',' + CHAR(13)
SET @sql = @sql + '[license_change_date] [varchar](max) ''$.license_change_date'',' + CHAR(13)
SET @sql = @sql + '[license_disc_photo_captured] [varchar](max) ''$.license_disc_photo_captured'',' + CHAR(13)
SET @sql = @sql + '[license_disk_present_captured_key] [varchar](max) ''$.license_disk_present_captured.key'',' + CHAR(13)
SET @sql = @sql + '[license_disk_present_captured_display] [varchar](max) ''$.license_disk_present_captured.display'',' + CHAR(13)
SET @sql = @sql + '[license_expiry_date] [varchar](max) ''$.license_expiry_date'',' + CHAR(13)
SET @sql = @sql + '[license_expiry_date_captured] [varchar](max) ''$.license_expiry_date_captured'',' + CHAR(13)
SET @sql = @sql + '[license_number] [varchar](max) ''$.license_number'',' + CHAR(13)
SET @sql = @sql + '[license_number_captured] [varchar](max) ''$.license_number_captured'',' + CHAR(13)
SET @sql = @sql + '[make_mismatch_captured] [varchar](max) ''$.make_mismatch_captured'',' + CHAR(13)
SET @sql = @sql + '[make_mismatch_description_captured] [varchar](max) ''$.make_mismatch_description_captured'',' + CHAR(13)
SET @sql = @sql + '[make_mismatch_potential_violation_captured] [varchar](max) ''$.make_mismatch_potential_violation_captured'',' + CHAR(13)
SET @sql = @sql + '[method_captured_key] [varchar](max) ''$.method_captured.key'',' + CHAR(13)
SET @sql = @sql + '[method_captured_display] [varchar](max) ''$.method_captured.display'',' + CHAR(13)
SET @sql = @sql + '[model_mismatch_captured] [varchar](max) ''$.model_mismatch_captured'',' + CHAR(13)
SET @sql = @sql + '[model_mismatch_description_captured] [varchar](max) ''$.model_mismatch_description_captured'',' + CHAR(13)
SET @sql = @sql + '[model_mismatch_potential_violation_captured] [varchar](max) ''$.model_mismatch_potential_violation_captured'',' + CHAR(13)
SET @sql = @sql + '[nature_of_person_description] [varchar](max) ''$.nature_of_person_description'',' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_captured] [varchar](max) ''$.numberplate_mismatch_captured'',' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_description_captured] [varchar](max) ''$.numberplate_mismatch_description_captured'',' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_potential_violation_captured] [varchar](max) ''$.numberplate_mismatch_potential_violation_captured'',' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_type_captured_key] [varchar](max) ''$.numberplate_mismatch_type_captured.key'',' + CHAR(13)
SET @sql = @sql + '[numberplate_mismatch_type_captured_display] [varchar](max) ''$.numberplate_mismatch_type_captured.display'',' + CHAR(13)
SET @sql = @sql + '[numberplate_photo_captured] [varchar](max) ''$.numberplate_photo_captured'',' + CHAR(13)
SET @sql = @sql + '[numberplate_present_captured_key] [varchar](max) ''$.numberplate_present_captured.key'',' + CHAR(13)
SET @sql = @sql + '[numberplate_present_captured_display] [varchar](max) ''$.numberplate_present_captured.display'',' + CHAR(13)
SET @sql = @sql + '[operating_license_number_captured] [varchar](max) ''$.operating_license_number_captured'',' + CHAR(13)
SET @sql = @sql + '[owner_id_document_number] [varchar](max) ''$.owner_id_document_number'',' + CHAR(13)
SET @sql = @sql + '[owner_id_document_type] [varchar](max) ''$.owner_id_document_type'',' + CHAR(13)
SET @sql = @sql + '[owner_id_document_type_code] [varchar](max) ''$.owner_id_document_type_code'',' + CHAR(13)
SET @sql = @sql + '[previous_license_number] [varchar](max) ''$.previous_license_number'',' + CHAR(13)
SET @sql = @sql + '[registration_description] [varchar](max) ''$.registration_description'',' + CHAR(13)
SET @sql = @sql + '[roadworthy_status] [varchar](max) ''$.roadworthy_status'',' + CHAR(13)
SET @sql = @sql + '[sap_clearance_status] [varchar](max) ''$.sap_clearance_status'',' + CHAR(13)
SET @sql = @sql + '[sap_mark_code] [varchar](max) ''$.sap_mark_code'',' + CHAR(13)
SET @sql = @sql + '[sap_mark_description] [varchar](max) ''$.sap_mark_description'',' + CHAR(13)
SET @sql = @sql + '[scan_registration_number] [varchar](max) ''$.scan_registration_number'',' + CHAR(13)
SET @sql = @sql + '[status_key] [varchar](max) ''$.status.key'',' + CHAR(13)
SET @sql = @sql + '[status_display] [varchar](max) ''$.status.display'',' + CHAR(13)
SET @sql = @sql + '[surname_business_name] [varchar](max) ''$.surname_business_name'',' + CHAR(13)
SET @sql = @sql + '[timestamp_captured] [varchar](max) ''$.timestamp_captured'',' + CHAR(13)
SET @sql = @sql + '[user_location_captured] [varchar](max) ''$.user_location_captured'',' + CHAR(13)
SET @sql = @sql + '[vehicle_1_key] [varchar](max) ''$.vehicle_1.key'',' + CHAR(13)
SET @sql = @sql + '[vehicle_1_display] [varchar](max) ''$.vehicle_1.display'',' + CHAR(13)
SET @sql = @sql + '[vehicle_2_key] [varchar](max) ''$.vehicle_2.key'',' + CHAR(13)
SET @sql = @sql + '[vehicle_2_display] [varchar](max) ''$.vehicle_2.display'',' + CHAR(13)
SET @sql = @sql + '[vehicle_3_key] [varchar](max) ''$.vehicle_3.key'',' + CHAR(13)
SET @sql = @sql + '[vehicle_3_display] [varchar](max) ''$.vehicle_3.display'',' + CHAR(13)
SET @sql = @sql + '[vehicle_colour] [varchar](max) ''$.vehicle_colour'',' + CHAR(13)
SET @sql = @sql + '[vehicle_colour_captured] [varchar](max) ''$.vehicle_colour_captured'',' + CHAR(13)
SET @sql = @sql + '[vehicle_description] [varchar](max) ''$.vehicle_description'',' + CHAR(13)
SET @sql = @sql + '[vehicle_description_captured] [varchar](max) ''$.vehicle_description_captured'',' + CHAR(13)
SET @sql = @sql + '[vehicle_designation_key] [varchar](max) ''$.vehicle_designation.key'',' + CHAR(13)
SET @sql = @sql + '[vehicle_designation_display] [varchar](max) ''$.vehicle_designation.display'',' + CHAR(13)
SET @sql = @sql + '[vehicle_gmv] [varchar](max) ''$.vehicle_gmv'',' + CHAR(13)
SET @sql = @sql + '[vehicle_make] [varchar](max) ''$.vehicle_make'',' + CHAR(13)
SET @sql = @sql + '[vehicle_make_captured] [varchar](max) ''$.vehicle_make_captured'',' + CHAR(13)
SET @sql = @sql + '[vehicle_model_description] [varchar](max) ''$.vehicle_model_description'',' + CHAR(13)
SET @sql = @sql + '[vehicle_model_description_captured] [varchar](max) ''$.vehicle_model_description_captured'',' + CHAR(13)
SET @sql = @sql + '[vehicle_register_number] [varchar](max) ''$.vehicle_register_number'',' + CHAR(13)
SET @sql = @sql + '[vehicle_register_number_captured] [varchar](max) ''$.vehicle_register_number_captured'',' + CHAR(13)
SET @sql = @sql + '[vehicle_registration_number] [varchar](max) ''$.vehicle_registration_number'',' + CHAR(13)
SET @sql = @sql + '[vehicle_registration_number_captured] [varchar](max) ''$.vehicle_registration_number_captured'',' + CHAR(13)
SET @sql = @sql + '[vehicle_state] [varchar](max) ''$.vehicle_state'',' + CHAR(13)
SET @sql = @sql + '[vehicle_usage_description] [varchar](max) ''$.vehicle_usage_description'',' + CHAR(13)
SET @sql = @sql + '[vin_chassis_mismatch_captured] [varchar](max) ''$.vin_chassis_mismatch_captured'',' + CHAR(13)
SET @sql = @sql + '[vin_chassis_mismatch_description_captured] [varchar](max) ''$.vin_chassis_mismatch_description_captured'',' + CHAR(13)
SET @sql = @sql + '[vin_chassis_mismatch_potential_violation_captured] [varchar](max) ''$.vin_chassis_mismatch_potential_violation_captured'',' + CHAR(13)
SET @sql = @sql + '[vin_chassis_number] [varchar](max) ''$.vin_chassis_number'',' + CHAR(13)
SET @sql = @sql + '[vin_chassis_number_captured] [varchar](max) ''$.vin_chassis_number_captured'',' + CHAR(13)
SET @sql = @sql + '[voluntary_lookup_key] [varchar](max) ''$.voluntary_lookup.key'',' + CHAR(13)
SET @sql = @sql + '[voluntary_lookup_display] [varchar](max) ''$.voluntary_lookup.display''' + CHAR(13)
--WITH End
SET @sql = @sql + ')' + CHAR(13)

EXEC(@SQL)


